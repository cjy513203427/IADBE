(IADBE) jinyao@jinyao-System-Product-Name:~/PycharmProjects/IADBE$ /bin/bash /home/jinyao/PycharmProjects/IADBE/test_mvtec_patchcoreleather.sh
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category screw --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:47:12,152 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:47:12] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:47:12,166 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:47:13,424 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:47:13] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:47:13,653 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:47:13,654 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:47:13,655 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:47:13,655 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:47:13,749 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:47:13] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:47:13,758 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:47:13,759 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:47:13,759 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:47:13,760 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:47:13,919 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:47:13,964 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:47:14,040 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
[08/14/24 10:47:14] INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:47:14,335 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:47:14,336 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:20 • 0:00:00 0.20it/s  2024-08-14 10:47:42,683 - anomalib.callbacks.timer - INFO - Testing took 28.14726972579956 seconds
Throughput (batch_size=32) : 5.684387919633473 FPS
[08/14/24 10:47:42] INFO     Testing took 28.14726972579956 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 5.684387919633473 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            0.5            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8666574358940125     │
│         pixel_PRO         │    0.9997380375862122     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:20 • 0:00:00 0.20it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category pill --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:47:48,423 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:47:48] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:47:48,437 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:47:49,714 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:47:49] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:47:49,970 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:47:49,972 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:47:49,972 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:47:49,973 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:47:50,066 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:47:50] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:47:50,075 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:47:50,076 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:47:50,076 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:47:50,077 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:47:50,146 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 10:47:50] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:47:50,189 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:47:50,265 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:47:50,561 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:47:50,562 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6/6 0:00:25 • 0:00:00 0.20it/s  2024-08-14 10:48:20,682 - anomalib.callbacks.timer - INFO - Testing took 29.863977670669556 seconds
Throughput (batch_size=32) : 5.592021325545541 FPS
[08/14/24 10:48:20] INFO     Testing took 29.863977670669556 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.592021325545541 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.4376704692840576     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.6110500693321228     │
│         pixel_PRO         │    0.9999969601631165     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6/6 0:00:25 • 0:00:00 0.20it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category capsule --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:48:26,526 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:48:26] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:48:26,540 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:48:27,834 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:48:27] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:48:28,060 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 10:48:28] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:48:28,061 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:48:28,062 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:48:28,063 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:48:28,157 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:48:28] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:48:28,165 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:48:28,166 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:48:28,167 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:48:28,168 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:48:28,277 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:48:28,320 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:48:28,392 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:48:28,676 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:48:28,678 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:22 • 0:00:00 0.18it/s  2024-08-14 10:48:55,307 - anomalib.callbacks.timer - INFO - Testing took 26.320634126663208 seconds
Throughput (batch_size=32) : 5.015076740354138 FPS
[08/14/24 10:48:55] INFO     Testing took 26.320634126663208 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.015076740354138 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            0.5            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8425185680389404     │
│         pixel_PRO         │            1.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:22 • 0:00:00 0.18it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category carpet --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:49:00,986 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:49:00] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:49:01,000 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
[08/14/24 10:49:01] INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:49:02,277 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:49:02] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:49:02,502 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:49:02,503 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:49:02,504 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:49:02,505 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:49:02,598 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:49:02] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:49:02,606 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:49:02,607 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:49:02,608 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:49:02,609 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:49:02,719 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:49:02,760 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:49:02,832 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:49:03,106 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 10:49:03] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:49:03,108 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:16 • 0:00:00 0.19it/s  2024-08-14 10:49:26,503 - anomalib.callbacks.timer - INFO - Testing took 23.099676847457886 seconds
Throughput (batch_size=32) : 5.065005920759269 FPS
[08/14/24 10:49:26] INFO     Testing took 23.099676847457886 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.065005920759269 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │     0.969101071357727     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9489927291870117     │
│         pixel_PRO         │    0.9424312710762024     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:16 • 0:00:00 0.19it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category grid --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:49:32,349 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:49:32] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:49:32,363 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:49:33,642 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:49:33] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:49:33,870 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:49:33,871 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:49:33,872 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:49:33,872 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:49:33,966 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:49:33] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:49:33,975 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:49:33,975 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:49:33,976 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:49:33,977 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:49:34,090 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 10:49:34] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:49:34,133 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 10:49:34] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:49:34,201 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:49:34,486 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:49:34,487 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:10 • 0:00:00 0.19it/s  2024-08-14 10:49:49,541 - anomalib.callbacks.timer - INFO - Testing took 14.775841236114502 seconds
Throughput (batch_size=32) : 5.278887256135077 FPS
[08/14/24 10:49:49] INFO     Testing took 14.775841236114502 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.278887256135077 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            0.5            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.3656701147556305     │
│         pixel_PRO         │    0.9967610836029053     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:10 • 0:00:00 0.19it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category tile --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:49:55,135 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:49:55] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:49:55,149 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:49:56,450 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:49:56] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:49:56,691 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:49:56,692 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:49:56,693 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:49:56,694 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:49:56,788 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:49:56] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:49:56,797 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:49:56,798 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:49:56,798 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:49:56,799 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:49:56,917 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:49:56,963 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:49:57,035 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
[08/14/24 10:49:57] INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:49:57,334 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:49:57,336 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:16 • 0:00:00 0.19it/s  2024-08-14 10:50:19,925 - anomalib.callbacks.timer - INFO - Testing took 22.24357032775879 seconds
Throughput (batch_size=32) : 5.259946954378553 FPS
[08/14/24 10:50:19] INFO     Testing took 22.24357032775879 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 5.259946954378553 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.8841992020606995     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.7696296572685242     │
│         pixel_PRO         │    0.8419762253761292     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:16 • 0:00:00 0.19it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category wood --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:50:25,805 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:50:25] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:50:25,819 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:50:27,126 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:50:27] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:50:27,353 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:50:27,354 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:50:27,355 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:50:27,356 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:50:27,450 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:50:27] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:50:27,459 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:50:27,460 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:50:27,460 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:50:27,461 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:50:27,525 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:50:27,568 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:50:27,637 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:50:27,918 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:50:27,919 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:11 • 0:00:00 0.18it/s  2024-08-14 10:50:44,940 - anomalib.callbacks.timer - INFO - Testing took 16.750622987747192 seconds
Throughput (batch_size=32) : 4.7162424978334965 FPS
[08/14/24 10:50:44] INFO     Testing took 16.750622987747192 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.7162424978334965 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9728070497512817     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8293081521987915     │
│         pixel_PRO         │    0.9404783844947815     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:11 • 0:00:00 0.18it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category zipper --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:50:50,678 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:50:50] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:50:50,692 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:50:51,950 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:50:51] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:50:52,181 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 10:50:52] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:50:52,182 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:50:52,183 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:50:52,183 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:50:52,277 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:50:52] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:50:52,285 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:50:52,286 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:50:52,287 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:50:52,288 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:50:52,393 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:50:52,437 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:50:52,511 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:50:52,806 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:50:52,807 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:20 • 0:00:00 0.20it/s  2024-08-14 10:51:20,094 - anomalib.callbacks.timer - INFO - Testing took 27.071155071258545 seconds
Throughput (batch_size=32) : 5.5778927645505885 FPS
[08/14/24 10:51:20] INFO     Testing took 27.071155071258545 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.5778927645505885 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            0.5            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8362035751342773     │
│         pixel_PRO         │     0.966496467590332     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:20 • 0:00:00 0.20it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category cable --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:51:25,655 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:51:25] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:51:25,669 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:51:26,937 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:51:26] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:51:27,184 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 10:51:27] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:51:27,185 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:51:27,186 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:51:27,187 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:51:27,281 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:51:27] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:51:27,290 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:51:27,291 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:51:27,291 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:51:27,292 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:51:27,358 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:51:27,401 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:51:27,474 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:51:27,736 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:51:27,737 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:24 • 0:00:00 0.17it/s  2024-08-14 10:51:59,135 - anomalib.callbacks.timer - INFO - Testing took 31.156789779663086 seconds
Throughput (batch_size=32) : 4.814359921570265 FPS
[08/14/24 10:51:59] INFO     Testing took 31.156789779663086 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.814359921570265 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            0.5            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5210670828819275     │
│         pixel_PRO         │            1.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:24 • 0:00:00 0.17it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category toothbrush --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:52:04,981 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:52:04] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:52:04,994 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:52:06,250 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:52:06] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:52:06,487 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:52:06,489 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:52:06,489 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:52:06,490 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:52:06,582 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:52:06] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:52:06,591 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:52:06,591 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:52:06,592 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:52:06,593 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:52:06,661 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:52:06,705 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:52:06,766 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:52:07,062 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 10:52:07] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:52:07,063 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2/2 0:00:05 • 0:00:00 0.18it/s  2024-08-14 10:52:17,011 - anomalib.callbacks.timer - INFO - Testing took 9.707817077636719 seconds
Throughput (batch_size=32) : 4.32641032109605 FPS
[08/14/24 10:52:17] INFO     Testing took 9.707817077636719 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 4.32641032109605 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            0.5            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.7806885838508606     │
│         pixel_PRO         │            1.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2/2 0:00:05 • 0:00:00 0.18it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category transistor --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:52:22,872 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:52:22] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:52:22,887 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:52:24,417 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:52:24] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:52:24,706 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:52:24,708 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:52:24,709 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:52:24,710 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:52:24,808 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:52:24] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:52:24,817 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:52:24,818 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:52:24,818 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:52:24,819 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:52:24,934 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:52:24,977 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:52:25,044 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
[08/14/24 10:52:25] INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:52:25,333 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:52:25,334 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:17 • 0:00:00 0.18it/s  2024-08-14 10:52:46,600 - anomalib.callbacks.timer - INFO - Testing took 20.981139659881592 seconds
Throughput (batch_size=32) : 4.766185327444903 FPS
[08/14/24 10:52:46] INFO     Testing took 20.981139659881592 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.766185327444903 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            0.5            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5838527083396912     │
│         pixel_PRO         │     0.998525857925415     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:17 • 0:00:00 0.18it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category metal_nut --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:52:52,351 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:52:52] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:52:52,366 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:52:53,666 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:52:53] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:52:53,901 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:52:53,902 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:52:53,903 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:52:53,904 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:52:53,997 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:52:53] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:52:54,006 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
[08/14/24 10:52:54] INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:52:54,007 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:52:54,007 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:52:54,008 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:52:54,118 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 10:52:54] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:52:54,161 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:52:54,233 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:52:54,527 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:52:54,528 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:15 • 0:00:00 0.20it/s  2024-08-14 10:53:15,020 - anomalib.callbacks.timer - INFO - Testing took 20.204151153564453 seconds
Throughput (batch_size=32) : 5.691899606468322 FPS
[08/14/24 10:53:15] INFO     Testing took 20.204151153564453 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.691899606468322 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            0.5            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.6793003678321838     │
│         pixel_PRO         │    0.9981332421302795     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:15 • 0:00:00 0.20it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category bottle --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:53:20,722 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:53:20] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:53:20,736 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:53:22,026 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:53:22] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:53:22,257 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:53:22,258 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:53:22,259 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:53:22,259 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:53:22,354 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:53:22] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:53:22,364 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:53:22,364 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:53:22,365 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:53:22,366 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:53:22,433 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:53:22,477 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:53:22,545 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:53:22,835 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:53:22,836 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:10 • 0:00:00 0.20it/s  2024-08-14 10:53:38,560 - anomalib.callbacks.timer - INFO - Testing took 15.462335109710693 seconds
Throughput (batch_size=32) : 5.367882626465271 FPS
[08/14/24 10:53:38] INFO     Testing took 15.462335109710693 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.367882626465271 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            0.5            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.4211597442626953     │
│         pixel_PRO         │    0.9999384880065918     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:10 • 0:00:00 0.20it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category hazelnut --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:53:44,227 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:53:44] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:53:44,242 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:53:45,831 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:53:45] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:53:46,061 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 10:53:46] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:53:46,062 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:53:46,063 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:53:46,063 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:53:46,158 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:53:46] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:53:46,168 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:53:46,169 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:53:46,169 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:53:46,170 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:53:46,282 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:53:46,325 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:53:46,398 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:53:46,686 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:53:46,688 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:16 • 0:00:00 0.18it/s  2024-08-14 10:54:08,942 - anomalib.callbacks.timer - INFO - Testing took 21.998229503631592 seconds
Throughput (batch_size=32) : 5.000402417923705 FPS
[08/14/24 10:54:08] INFO     Testing took 21.998229503631592 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.000402417923705 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.7985714673995972     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8589349389076233     │
│         pixel_PRO         │            1.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:16 • 0:00:00 0.18it/s
Running command: anomalib test --config ../configs/models/patchcore.yaml --data anomalib.data.MVTec --data.category leather --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/latest/weights/lightning/model.ckpt
2024-08-14 10:54:14,668 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 10:54:14] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 10:54:14,682 - anomalib.models.components.base.anomaly_module - INFO - Initializing Patchcore model.
                    INFO     Initializing Patchcore model.                                                                                                                                             anomaly_module.py:42
2024-08-14 10:54:15,984 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 10:54:15] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 10:54:16,208 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 10:54:16] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 10:54:16,209 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Patchcore
                    INFO     Overriding gradient_clip_val from None with 0 for Patchcore                                                                                                                       engine.py:84
2024-08-14 10:54:16,210 - anomalib.engine.engine - INFO - Overriding max_epochs from None with 1 for Patchcore
                    INFO     Overriding max_epochs from None with 1 for Patchcore                                                                                                                              engine.py:84
2024-08-14 10:54:16,210 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Patchcore
                    INFO     Overriding num_sanity_val_steps from None with 0 for Patchcore                                                                                                                    engine.py:84
2024-08-14 10:54:16,304 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 10:54:16] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 10:54:16,313 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 10:54:16,314 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 10:54:16,315 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:54:16,315 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 10:54:16,425 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 10:54:16,468 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 10:54:16,540 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                rank_zero.py:63
2024-08-14 10:54:16,814 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 10:54:16,816 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Patchcore/MVTec/leather/v1/weights/lightning/model.ckpt                                 rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:15 • 0:00:00 0.19it/s  2024-08-14 10:54:40,495 - anomalib.callbacks.timer - INFO - Testing took 23.38245964050293 seconds
Throughput (batch_size=32) : 5.303120454667997 FPS
[08/14/24 10:54:40] INFO     Testing took 23.38245964050293 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 5.303120454667997 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │            1.0            │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9899296760559082     │
│         pixel_PRO         │     0.573797345161438     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:15 • 0:00:00 0.19it/s





