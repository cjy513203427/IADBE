(IADBE) jinyao@jinyao-System-Product-Name:~/PycharmProjects/IADBE$ /bin/bash /home/jinyao/PycharmProjects/IADBE/test_mvtec_draem_bottle_not_finished.sh
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category screw --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:25:41,977 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:25:41] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:25:41,994 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:25:42,540 - anomalib.callbacks - INFO - Loading the callbacks
[08/15/24 10:25:42] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:25:42,541 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:25:42,542 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:25:42,634 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:25:42] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:25:42,643 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:25:42,644 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:25:42,645 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:25:42,646 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:25:43,448 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:25:43] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:25:43,493 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:25:43] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:25:43,574 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:25:44,631 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:25:44] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:25:44,633 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:22 • 0:00:00 0.18it/s  2024-08-15 10:26:15,422 - anomalib.callbacks.timer - INFO - Testing took 30.398573398590088 seconds
Throughput (batch_size=32) : 5.263404894106674 FPS
[08/15/24 10:26:15] INFO     Testing took 30.398573398590088 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.263404894106674 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.5101455450057983     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.3204178512096405     │
│         pixel_PRO         │    0.8489872813224792     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:22 • 0:00:00 0.18it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category pill --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:26:21,338 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:26:21] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:26:21,354 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:26:21,884 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:26:21,885 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:26:21,886 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:26:21,979 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:26:21] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:26:21,988 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:26:21,989 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:26:21,989 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:26:21,990 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:26:22,934 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:26:22] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:26:22,977 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:26:22] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:26:23,059 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
[08/15/24 10:26:23] INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:26:23,922 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:26:23,923 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6/6 0:00:27 • 0:00:00 0.19it/s  2024-08-15 10:26:55,398 - anomalib.callbacks.timer - INFO - Testing took 31.097711324691772 seconds
Throughput (batch_size=32) : 5.3701701149756635 FPS
[08/15/24 10:26:55] INFO     Testing took 31.097711324691772 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.3701701149756635 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.3977086842060089     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.7971848249435425     │
│         pixel_PRO         │    0.9001341462135315     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6/6 0:00:27 • 0:00:00 0.19it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category capsule --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:27:01,283 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:27:01] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:27:01,300 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:27:01,828 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:27:01,829 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:27:01,830 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:27:01,922 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:27:01] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:27:01,931 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:27:01,932 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:27:01,932 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:27:01,933 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:27:02,694 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:27:02] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:27:02,738 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:27:02] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:27:02,817 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:27:03,697 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:27:03] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:27:03,699 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:26 • 0:00:00 0.16it/s  2024-08-15 10:27:33,470 - anomalib.callbacks.timer - INFO - Testing took 29.354156255722046 seconds
Throughput (batch_size=32) : 4.496807840432105 FPS
[08/15/24 10:27:33] INFO     Testing took 29.354156255722046 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.496807840432105 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.5376944541931152     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.21293862164020538    │
│         pixel_PRO         │     0.482807457447052     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:26 • 0:00:00 0.16it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category carpet --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:27:39,243 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:27:39] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:27:39,260 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:27:39,787 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:27:39,788 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:27:39,789 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:27:39,881 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:27:39] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:27:39,890 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:27:39,891 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:27:39,891 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:27:39,892 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:27:40,673 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:27:40] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:27:40,717 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:27:40] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:27:40,794 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:27:41,660 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:27:41] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:27:41,662 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:20 • 0:00:00 0.15it/s  2024-08-15 10:28:09,590 - anomalib.callbacks.timer - INFO - Testing took 27.505943298339844 seconds
Throughput (batch_size=32) : 4.253626161116302 FPS
[08/15/24 10:28:09] INFO     Testing took 27.505943298339844 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.253626161116302 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.6023274660110474     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5191799998283386     │
│         pixel_PRO         │    0.6698558926582336     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:20 • 0:00:00 0.15it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category grid --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:28:15,348 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:28:15] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:28:15,365 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:28:15,892 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:28:15,893 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:28:15,894 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:28:15,986 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:28:15] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:28:15,994 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:28:15,995 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:28:15,996 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:28:15,997 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:28:16,763 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:28:16] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:28:16,809 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:28:16] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:28:16,883 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:28:17,757 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:28:17] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:28:17,758 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:13 • 0:00:00 0.16it/s  2024-08-15 10:28:35,851 - anomalib.callbacks.timer - INFO - Testing took 17.66555142402649 seconds
Throughput (batch_size=32) : 4.415373068621797 FPS
[08/15/24 10:28:35] INFO     Testing took 17.66555142402649 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 4.415373068621797 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.5154553055763245     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.3088032603263855     │
│         pixel_PRO         │    0.39652401208877563    │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:13 • 0:00:00 0.16it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category tile --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:28:41,732 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:28:41] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:28:41,748 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:28:42,278 - anomalib.callbacks - INFO - Loading the callbacks
[08/15/24 10:28:42] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:28:42,280 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:28:42,280 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:28:42,372 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:28:42] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:28:42,381 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:28:42,382 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:28:42,383 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:28:42,383 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:28:43,102 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:28:43] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:28:43,129 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:28:43] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:28:43,205 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:28:44,062 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:28:44] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:28:44,063 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:17 • 0:00:00 0.18it/s  2024-08-15 10:29:08,538 - anomalib.callbacks.timer - INFO - Testing took 24.102640390396118 seconds
Throughput (batch_size=32) : 4.854239954831652 FPS
[08/15/24 10:29:08] INFO     Testing took 24.102640390396118 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.854239954831652 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.7124819755554199     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5784656405448914     │
│         pixel_PRO         │    0.6931893825531006     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:17 • 0:00:00 0.18it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category wood --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:29:14,266 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:29:14] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:29:14,282 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:29:14,810 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:29:14,811 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:29:14,812 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:29:14,904 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:29:14] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:29:14,913 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:29:14,914 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:29:14,914 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:29:14,915 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:29:15,688 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:29:15] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:29:15,732 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:29:15] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:29:15,806 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:29:16,666 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:29:16] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:29:16,668 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:12 • 0:00:00 0.17it/s  2024-08-15 10:29:34,586 - anomalib.callbacks.timer - INFO - Testing took 17.56087017059326 seconds
Throughput (batch_size=32) : 4.498638121719633 FPS
[08/15/24 10:29:34] INFO     Testing took 17.56087017059326 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 4.498638121719633 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.8912280201911926     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5143970251083374     │
│         pixel_PRO         │    0.8766974210739136     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:12 • 0:00:00 0.17it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category zipper --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:29:40,685 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:29:40] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:29:40,701 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:29:41,214 - anomalib.callbacks - INFO - Loading the callbacks
[08/15/24 10:29:41] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:29:41,216 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:29:41,216 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:29:41,308 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:29:41] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:29:41,317 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:29:41,318 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:29:41,319 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:29:41,319 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:29:41,998 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:29:42,041 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:29:42] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:29:42,120 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:29:42,995 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:29:42,997 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:27 • 0:00:00 0.15it/s  2024-08-15 10:30:19,003 - anomalib.callbacks.timer - INFO - Testing took 35.73097538948059 seconds
Throughput (batch_size=32) : 4.22602513236891 FPS
[08/15/24 10:30:19] INFO     Testing took 35.73097538948059 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 4.22602513236891 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.6110818982124329     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.40159541368484497    │
│         pixel_PRO         │    0.40694016218185425    │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:27 • 0:00:00 0.15it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category cable --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:30:24,950 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:30:24] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:30:24,967 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:30:25,495 - anomalib.callbacks - INFO - Loading the callbacks
[08/15/24 10:30:25] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:30:25,496 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:30:25,497 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:30:25,589 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:30:25] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:30:25,598 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:30:25,599 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:30:25,599 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:30:25,600 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:30:26,284 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:30:26] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:30:26,329 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:30:26] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:30:26,407 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:30:27,259 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:30:27] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:30:27,260 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:26 • 0:00:00 0.16it/s  2024-08-15 10:31:01,766 - anomalib.callbacks.timer - INFO - Testing took 34.188400983810425 seconds
Throughput (batch_size=32) : 4.387452927998329 FPS
[08/15/24 10:31:01] INFO     Testing took 34.188400983810425 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.387452927998329 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.5316717028617859     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.4723067283630371     │
│         pixel_PRO         │    0.1638929694890976     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:26 • 0:00:00 0.16it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category toothbrush --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:31:07,736 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:31:07] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:31:07,753 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:31:08,277 - anomalib.callbacks - INFO - Loading the callbacks
[08/15/24 10:31:08] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:31:08,279 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:31:08,279 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:31:08,371 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:31:08] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:31:08,379 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:31:08,380 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:31:08,381 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:31:08,382 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:31:09,076 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:31:09] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:31:09,129 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:31:09] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:31:09,196 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:31:10,051 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:31:10] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:31:10,052 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2/2 0:00:06 • 0:00:00 0.18it/s  2024-08-15 10:31:20,395 - anomalib.callbacks.timer - INFO - Testing took 10.022679567337036 seconds
Throughput (batch_size=32) : 4.19049613607064 FPS
[08/15/24 10:31:20] INFO     Testing took 10.022679567337036 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.19049613607064 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │     0.444444477558136     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.8305914402008057     │
│         pixel_PRO         │    0.5537557601928711     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2/2 0:00:06 • 0:00:00 0.18it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category transistor --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:31:26,280 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:31:26] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:31:26,297 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:31:26,823 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:31:26,825 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:31:26,826 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:31:26,918 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:31:26] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:31:26,926 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:31:26,927 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:31:26,928 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:31:26,929 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:31:27,625 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:31:27] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:31:27,670 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:31:27] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:31:27,743 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:31:28,591 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:31:28] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:31:28,593 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:19 • 0:00:00 0.16it/s  2024-08-15 10:31:51,655 - anomalib.callbacks.timer - INFO - Testing took 22.722074031829834 seconds
Throughput (batch_size=32) : 4.401006697712396 FPS
[08/15/24 10:31:51] INFO     Testing took 22.722074031829834 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.401006697712396 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.43000003695487976    │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.44854557514190674    │
│         pixel_PRO         │    0.43018290400505066    │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:19 • 0:00:00 0.16it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category metal_nut --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:31:57,441 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:31:57] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:31:57,457 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:31:57,985 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:31:57,986 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:31:57,987 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:31:58,080 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:31:58] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:31:58,088 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:31:58,089 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:31:58,090 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:31:58,091 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:31:58,787 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:31:58] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:31:58,833 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:31:58,910 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:31:59,768 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:31:59] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:31:59,769 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:16 • 0:00:00 0.19it/s  2024-08-15 10:32:21,766 - anomalib.callbacks.timer - INFO - Testing took 21.657743215560913 seconds
Throughput (batch_size=32) : 5.309879189876692 FPS
[08/15/24 10:32:21] INFO     Testing took 21.657743215560913 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.309879189876692 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.2825024425983429     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.7436259984970093     │
│         pixel_PRO         │    0.5769506096839905     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:16 • 0:00:00 0.19it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category bottle --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:32:27,499 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:32:27] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:32:27,515 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:32:28,040 - anomalib.callbacks - INFO - Loading the callbacks
[08/15/24 10:32:28] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:32:28,042 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:32:28,042 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:32:28,134 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:32:28] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:32:28,142 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:32:28,143 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:32:28,144 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:32:28,145 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:32:28,846 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:32:28,890 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
                    INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:32:28,971 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:32:29,827 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:32:29] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:32:29,828 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:11 • 0:00:00 0.19it/s  2024-08-15 10:32:46,608 - anomalib.callbacks.timer - INFO - Testing took 16.456250190734863 seconds
Throughput (batch_size=32) : 5.043676356277711 FPS
[08/15/24 10:32:46] INFO     Testing took 16.456250190734863 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 5.043676356277711 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9753968715667725     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.7321674227714539     │
│         pixel_PRO         │    0.4300192594528198     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:11 • 0:00:00 0.19it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category hazelnut --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:32:52,590 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:32:52] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-15 10:32:52,606 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                 anomaly_module.py:42
2024-08-15 10:32:53,137 - anomalib.callbacks - INFO - Loading the callbacks
[08/15/24 10:32:53] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-15 10:32:53,138 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                           engine.py:84
2024-08-15 10:32:53,139 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                        engine.py:84
2024-08-15 10:32:53,231 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:32:53] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-15 10:32:53,240 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-15 10:32:53,241 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-15 10:32:53,241 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:32:53,242 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-15 10:32:53,996 - anomalib.data.image.mvtec - INFO - Found the dataset.
                    INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-15 10:32:54,041 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:32:54] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:32:54,120 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                     rank_zero.py:63
2024-08-15 10:32:54,976 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
                    INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-15 10:32:54,977 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                      rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:18 • 0:00:00 0.17it/s  2024-08-15 10:33:18,761 - anomalib.callbacks.timer - INFO - Testing took 23.432185649871826 seconds
Throughput (batch_size=32) : 4.694397767397413 FPS
[08/15/24 10:33:18] INFO     Testing took 23.432185649871826 seconds                                                                                                                                                    timer.py:109
                             Throughput (batch_size=32) : 4.694397767397413 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.7139285206794739     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │     0.775234043598175     │
│         pixel_PRO         │    0.7848747968673706     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:18 • 0:00:00 0.17it/s
Running command: anomalib test --config ../configs/models/draem.yaml --data anomalib.data.MVTec --data.category leather --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/latest/weights/lightning/model.ckpt
2024-08-15 10:33:25,070 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/15/24 10:33:25] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                             config.py:262
2024-08-15 10:33:25,087 - anomalib.models.components.base.anomaly_module - INFO - Initializing Draem model.
                    INFO     Initializing Draem model.                                                                                                                                                          anomaly_module.py:42
2024-08-15 10:33:25,612 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                                    __init__.py:43
2024-08-15 10:33:25,613 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Draem
                    INFO     Overriding gradient_clip_val from None with 0 for Draem                                                                                                                                    engine.py:84
2024-08-15 10:33:25,614 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Draem
                    INFO     Overriding num_sanity_val_steps from None with 0 for Draem                                                                                                                                 engine.py:84
2024-08-15 10:33:25,706 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/15/24 10:33:25] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary`         rank_zero.py:63
                             callback.
2024-08-15 10:33:25,714 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                                  rank_zero.py:63
2024-08-15 10:33:25,715 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                                rank_zero.py:63
2024-08-15 10:33:25,716 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                                     rank_zero.py:63
2024-08-15 10:33:25,717 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                                     rank_zero.py:63
2024-08-15 10:33:26,421 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/15/24 10:33:26] INFO     Found the dataset.                                                                                                                                                                         mvtec.py:412
2024-08-15 10:33:26,466 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/15/24 10:33:26] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which   rank_zero.py:63
                             will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-15 10:33:26,551 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                              rank_zero.py:63
2024-08-15 10:33:27,403 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/15/24 10:33:27] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                                    cuda.py:58
2024-08-15 10:33:27,404 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Draem/MVTec/bottle/v3/weights/lightning/model.ckpt                                               rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:19 • 0:00:00 0.16it/s  2024-08-15 10:33:56,262 - anomalib.callbacks.timer - INFO - Testing took 28.541998386383057 seconds
Throughput (batch_size=32) : 4.344475054667457 FPS
[08/15/24 10:33:56] INFO     Testing took 28.541998386383057 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.344475054667457 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.7724183797836304     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.41946566104888916    │
│         pixel_PRO         │    0.4685417413711548     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:19 • 0:00:00 0.16it/s

