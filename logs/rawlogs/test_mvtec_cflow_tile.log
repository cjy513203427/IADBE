/bin/bash /home/jinyao/PycharmProjects/IADBE/test_mvtec_cflow_tile.sh
(IADBE) jinyao@jinyao-System-Product-Name:~/PycharmProjects/IADBE$ /bin/bash /home/jinyao/PycharmProjects/IADBE/test_mvtec_cflow_tile.sh
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category screw --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:26:27,348 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:26:27] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:26:27,365 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:26:28,652 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:26:28] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:26:28,867 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:26:28,902 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:26:28,987 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:26:29,334 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:26:29] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:26:29,335 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:26:29,336 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:26:29,429 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:26:29] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:26:29,439 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:26:29,439 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:26:29,440 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:26:29,441 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:26:30,415 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:26:30] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:26:30,457 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:26:30] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:26:30,544 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:26:31,872 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:26:31] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:26:31,874 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:27 • 0:00:00 0.16it/s  2024-08-14 11:27:08,174 - anomalib.callbacks.timer - INFO - Testing took 35.85310125350952 seconds
Throughput (batch_size=32) : 4.462654398253434 FPS
[08/14/24 11:27:08] INFO     Testing took 35.85310125350952 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 4.462654398253434 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9244721531867981     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.7722618579864502     │
│         pixel_PRO         │    0.12373924255371094    │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:27 • 0:00:00 0.16it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category pill --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:27:14,373 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:27:14] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:27:14,390 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:27:15,670 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:27:15] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:27:15,875 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:27:15,902 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:27:15,985 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:27:16,316 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:27:16] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:27:16,317 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:27:16,318 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:27:16,411 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:27:16] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:27:16,420 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:27:16,421 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:27:16,422 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:27:16,422 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:27:17,331 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:27:17] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:27:17,374 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:27:17] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:27:17,460 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:27:18,664 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:27:18] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:27:18,666 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6/6 0:00:32 • 0:00:00 0.17it/s  2024-08-14 11:27:55,934 - anomalib.callbacks.timer - INFO - Testing took 36.88884997367859 seconds
Throughput (batch_size=32) : 4.527113209524288 FPS
[08/14/24 11:27:55] INFO     Testing took 36.88884997367859 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 4.527113209524288 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.19585378468036652    │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.6988986134529114     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6/6 0:00:32 • 0:00:00 0.17it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category capsule --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:28:02,411 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:28:02] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:28:02,428 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:28:03,691 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:28:03] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:28:03,907 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:28:03,934 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:28:04,018 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
[08/14/24 11:28:04] INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:28:04,346 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:28:04,347 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:28:04,348 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:28:04,441 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:28:04] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:28:04,449 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:28:04,450 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:28:04,451 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:28:04,451 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:28:05,356 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:28:05] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:28:05,401 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:28:05] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:28:05,482 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:28:06,693 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:28:06] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:28:06,694 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:28 • 0:00:00 0.15it/s  2024-08-14 11:28:40,053 - anomalib.callbacks.timer - INFO - Testing took 33.04930353164673 seconds
Throughput (batch_size=32) : 3.9940327297246045 FPS
[08/14/24 11:28:40] INFO     Testing took 33.04930353164673 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 3.9940327297246045 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.12903869152069092    │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.6742502450942993     │
│         pixel_PRO         │    0.0416666679084301     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:28 • 0:00:00 0.15it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category carpet --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:28:46,184 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:28:46] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:28:46,201 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:28:47,466 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:28:47] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:28:47,683 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:28:47,709 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:28:47,794 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:28:48,125 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:28:48] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:28:48,126 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:28:48,127 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:28:48,221 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:28:48] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:28:48,229 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:28:48,230 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:28:48,231 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:28:48,232 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:28:49,135 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:28:49] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:28:49,177 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:28:49] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:28:49,258 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:28:50,474 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:28:50] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:28:50,476 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:22 • 0:00:00 0.15it/s  2024-08-14 11:29:20,311 - anomalib.callbacks.timer - INFO - Testing took 29.522754430770874 seconds
Throughput (batch_size=32) : 3.9630448532286557 FPS
[08/14/24 11:29:20] INFO     Testing took 29.522754430770874 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 3.9630448532286557 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │     0.983146071434021     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5441721081733704     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:22 • 0:00:00 0.15it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category grid --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:29:26,568 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:29:26] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:29:26,585 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:29:27,851 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:29:27] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:29:28,069 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
[08/14/24 11:29:28] INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:29:28,096 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:29:28,179 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:29:28,508 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:29:28,510 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:29:28,510 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:29:28,605 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:29:28] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:29:28,614 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:29:28,615 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:29:28,615 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:29:28,616 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:29:29,524 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:29:29] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:29:29,570 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:29:29] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:29:29,648 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:29:30,862 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:29:30] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:29:30,864 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:14 • 0:00:00 0.16it/s  2024-08-14 11:29:49,871 - anomalib.callbacks.timer - INFO - Testing took 18.691957473754883 seconds
Throughput (batch_size=32) : 4.172917689841672 FPS
[08/14/24 11:29:49] INFO     Testing took 18.691957473754883 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.172917689841672 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.11988303810358047    │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.2239154875278473     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:14 • 0:00:00 0.16it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category tile --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:29:56,151 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:29:56] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:29:56,168 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:29:57,437 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:29:57] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:29:57,654 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:29:57,681 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:29:57,765 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:29:58,094 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:29:58] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:29:58,095 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:29:58,096 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:29:58,190 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:29:58] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:29:58,199 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:29:58,199 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:29:58,200 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:29:58,201 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:29:59,107 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:29:59] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:29:59,149 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:29:59] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:29:59,229 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:30:00,575 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:30:00] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:30:00,577 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:21 • 0:00:00 0.15it/s  2024-08-14 11:30:28,871 - anomalib.callbacks.timer - INFO - Testing took 27.939531803131104 seconds
Throughput (batch_size=32) : 4.187614911531486 FPS
[08/14/24 11:30:28] INFO     Testing took 27.939531803131104 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 4.187614911531486 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9902596473693848     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.9484976530075073     │
│         pixel_PRO         │    0.8362878561019897     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:21 • 0:00:00 0.15it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category wood --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:30:35,334 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:30:35] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:30:35,352 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:30:36,626 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:30:36] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:30:36,838 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:30:36,865 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:30:36,948 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:30:37,279 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:30:37] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:30:37,281 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:30:37,281 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:30:37,375 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:30:37] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:30:37,384 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:30:37,385 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:30:37,386 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:30:37,386 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:30:38,292 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:30:38] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:30:38,338 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:30:38] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:30:38,416 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:30:39,618 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:30:39] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:30:39,620 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:15 • 0:00:00 0.15it/s  2024-08-14 11:31:00,184 - anomalib.callbacks.timer - INFO - Testing took 20.199902534484863 seconds
Throughput (batch_size=32) : 3.9109099593492003 FPS
[08/14/24 11:31:00] INFO     Testing took 20.199902534484863 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 3.9109099593492003 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │     0.355701744556427     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5131721496582031     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:15 • 0:00:00 0.15it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category zipper --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:31:06,860 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:31:06] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:31:06,877 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:31:08,143 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:31:08] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:31:08,355 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:31:08,390 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:31:08,483 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:31:08,822 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:31:08,824 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:31:08,824 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:31:08,922 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:31:08] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:31:08,931 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:31:08,932 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:31:08,932 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:31:08,933 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:31:09,831 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:31:09] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:31:09,873 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:31:09] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:31:09,956 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:31:11,158 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:31:11] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:31:11,159 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:27 • 0:00:00 0.16it/s  2024-08-14 11:31:45,432 - anomalib.callbacks.timer - INFO - Testing took 33.91301918029785 seconds
Throughput (batch_size=32) : 4.452567292732377 FPS
[08/14/24 11:31:45] INFO     Testing took 33.91301918029785 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 4.452567292732377 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.3025210201740265     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.4951511025428772     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:27 • 0:00:00 0.16it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category cable --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:31:52,070 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:31:52] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:31:52,088 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:31:53,359 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:31:53] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:31:53,576 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:31:53,603 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:31:53,688 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:31:54,020 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:31:54] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:31:54,021 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:31:54,022 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:31:54,116 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:31:54] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:31:54,125 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:31:54,126 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:31:54,127 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:31:54,128 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:31:55,034 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:31:55] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:31:55,077 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:31:55] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:31:55,159 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:31:56,389 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:31:56] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:31:56,391 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:30 • 0:00:00 0.14it/s  2024-08-14 11:32:34,372 - anomalib.callbacks.timer - INFO - Testing took 37.67333793640137 seconds
Throughput (batch_size=32) : 3.981595691181494 FPS
[08/14/24 11:32:34] INFO     Testing took 37.67333793640137 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 3.981595691181494 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.37443774938583374    │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5375739932060242     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5/5 0:00:30 • 0:00:00 0.14it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category toothbrush --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:32:41,314 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:32:41] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:32:41,332 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:32:42,625 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:32:42] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:32:42,850 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:32:42,885 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:32:42,975 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:32:43,315 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:32:43] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:32:43,316 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:32:43,317 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:32:43,412 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:32:43] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:32:43,421 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:32:43,422 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:32:43,422 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:32:43,423 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:32:44,358 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:32:44] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:32:44,402 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:32:44] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:32:44,474 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:32:45,733 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:32:45] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:32:45,735 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2/2 0:00:08 • 0:00:00 0.17it/s  2024-08-14 11:32:58,203 - anomalib.callbacks.timer - INFO - Testing took 12.15109634399414 seconds
Throughput (batch_size=32) : 3.4564782313456943 FPS
[08/14/24 11:32:58] INFO     Testing took 12.15109634399414 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 3.4564782313456943 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9166666269302368     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.7003834247589111     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2/2 0:00:08 • 0:00:00 0.17it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category transistor --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:33:05,018 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:33:05] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:33:05,036 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:33:06,340 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:33:06] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:33:06,566 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:33:06,592 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:33:06,672 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:33:07,008 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:33:07] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:33:07,010 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:33:07,010 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:33:07,104 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:33:07] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:33:07,113 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:33:07,114 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:33:07,115 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:33:07,115 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:33:08,046 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:33:08] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:33:08,090 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:33:08] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:33:08,169 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:33:09,466 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:33:09] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:33:09,467 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:22 • 0:00:00 0.15it/s  2024-08-14 11:33:35,894 - anomalib.callbacks.timer - INFO - Testing took 26.124011039733887 seconds
Throughput (batch_size=32) : 3.8278961009434123 FPS
[08/14/24 11:33:35] INFO     Testing took 26.124011039733887 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 3.8278961009434123 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.8700000047683716     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5629361867904663     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:22 • 0:00:00 0.15it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category metal_nut --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:33:42,714 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:33:42] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:33:42,731 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:33:44,031 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:33:44] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:33:44,270 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:33:44,296 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:33:44,379 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:33:44,715 - anomalib.callbacks - INFO - Loading the callbacks
                    INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:33:44,716 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:33:44,717 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:33:44,812 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:33:44] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:33:44,821 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:33:44,821 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:33:44,822 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:33:44,823 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:33:45,770 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:33:45] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:33:45,814 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:33:45] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:33:45,897 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:33:47,194 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:33:47] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:33:47,195 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:20 • 0:00:00 0.16it/s  2024-08-14 11:34:14,492 - anomalib.callbacks.timer - INFO - Testing took 26.97687602043152 seconds
Throughput (batch_size=32) : 4.262910201792908 FPS
[08/14/24 11:34:14] INFO     Testing took 26.97687602043152 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 4.262910201792908 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.9462365508079529     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.5828016996383667     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:20 • 0:00:00 0.16it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category bottle --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:34:21,937 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:34:21] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:34:21,955 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:34:23,394 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:34:23] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:34:23,674 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:34:23,709 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:34:23,796 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:34:24,154 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:34:24] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:34:24,155 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:34:24,156 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:34:24,251 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:34:24] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:34:24,260 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:34:24,261 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:34:24,262 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:34:24,263 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:34:25,297 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:34:25] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:34:25,344 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:34:25] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:34:25,425 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:34:26,880 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:34:26] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:34:26,881 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:16 • 0:00:00 0.14it/s  2024-08-14 11:34:48,903 - anomalib.callbacks.timer - INFO - Testing took 21.688096523284912 seconds
Throughput (batch_size=32) : 3.826984074461722 FPS
[08/14/24 11:34:48] INFO     Testing took 21.688096523284912 seconds                                                                                                                                           timer.py:109
                             Throughput (batch_size=32) : 3.826984074461722 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │   0.012301590293645859    │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │     0.433295339345932     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3/3 0:00:16 • 0:00:00 0.14it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category hazelnut --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:34:56,886 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:34:56] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:34:56,904 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:34:58,289 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:34:58] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:34:58,549 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:34:58,584 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:34:58,670 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:34:59,035 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:34:59] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:34:59,037 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:34:59,038 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:34:59,131 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:34:59] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:34:59,140 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:34:59,141 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:34:59,142 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:34:59,143 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:35:00,166 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:35:00] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:35:00,211 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:35:00] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:35:00,296 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:35:01,847 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:35:01] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:35:01,849 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:24 • 0:00:00 0.13it/s  2024-08-14 11:35:33,486 - anomalib.callbacks.timer - INFO - Testing took 31.28971266746521 seconds
Throughput (batch_size=32) : 3.5155324425326895 FPS
[08/14/24 11:35:33] INFO     Testing took 31.28971266746521 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 3.5155324425326895 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.06857142597436905    │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.4517659842967987     │
│         pixel_PRO         │   0.022745372727513313    │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:24 • 0:00:00 0.13it/s
Running command: anomalib test --config ../configs/models/cflow.yaml --data anomalib.data.MVTec --data.category leather --ckpt_path /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/latest/weights/lightning/model.ckpt
2024-08-14 11:35:41,208 - anomalib.utils.config - WARNING - Anomalib currently does not support multi-gpu training. Setting devices to 1.
[08/14/24 11:35:41] WARNING  Anomalib currently does not support multi-gpu training. Setting devices to 1.                                                                                                    config.py:262
2024-08-14 11:35:41,226 - anomalib.models.components.base.anomaly_module - INFO - Initializing Cflow model.
                    INFO     Initializing Cflow model.                                                                                                                                                 anomaly_module.py:42
2024-08-14 11:35:42,596 - timm.models.helpers - INFO - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
[08/14/24 11:35:42] INFO     Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)                          helpers.py:247
2024-08-14 11:35:42,861 - anomalib.models.image.cflow.utils - INFO - CNF coder: 512
                    INFO     CNF coder: 512                                                                                                                                                                    utils.py:108
2024-08-14 11:35:42,892 - anomalib.models.image.cflow.utils - INFO - CNF coder: 1024
                    INFO     CNF coder: 1024                                                                                                                                                                   utils.py:108
2024-08-14 11:35:42,964 - anomalib.models.image.cflow.utils - INFO - CNF coder: 2048
                    INFO     CNF coder: 2048                                                                                                                                                                   utils.py:108
2024-08-14 11:35:43,314 - anomalib.callbacks - INFO - Loading the callbacks
[08/14/24 11:35:43] INFO     Loading the callbacks                                                                                                                                                           __init__.py:43
2024-08-14 11:35:43,315 - anomalib.engine.engine - INFO - Overriding gradient_clip_val from None with 0 for Cflow
                    INFO     Overriding gradient_clip_val from None with 0 for Cflow                                                                                                                           engine.py:84
2024-08-14 11:35:43,316 - anomalib.engine.engine - INFO - Overriding num_sanity_val_steps from None with 0 for Cflow
                    INFO     Overriding num_sanity_val_steps from None with 0 for Cflow                                                                                                                        engine.py:84
2024-08-14 11:35:43,410 - lightning.pytorch.utilities.rank_zero - INFO - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[08/14/24 11:35:43] INFO     Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default               rank_zero.py:63
                             `ModelSummary` callback.
2024-08-14 11:35:43,419 - lightning.pytorch.utilities.rank_zero - INFO - GPU available: True (cuda), used: True
                    INFO     GPU available: True (cuda), used: True                                                                                                                                         rank_zero.py:63
2024-08-14 11:35:43,420 - lightning.pytorch.utilities.rank_zero - INFO - TPU available: False, using: 0 TPU cores
                    INFO     TPU available: False, using: 0 TPU cores                                                                                                                                       rank_zero.py:63
2024-08-14 11:35:43,421 - lightning.pytorch.utilities.rank_zero - INFO - IPU available: False, using: 0 IPUs
                    INFO     IPU available: False, using: 0 IPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:35:43,422 - lightning.pytorch.utilities.rank_zero - INFO - HPU available: False, using: 0 HPUs
                    INFO     HPU available: False, using: 0 HPUs                                                                                                                                            rank_zero.py:63
2024-08-14 11:35:44,446 - anomalib.data.image.mvtec - INFO - Found the dataset.
[08/14/24 11:35:44] INFO     Found the dataset.                                                                                                                                                                mvtec.py:412
2024-08-14 11:35:44,491 - lightning.pytorch.utilities.rank_zero - INFO - You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[08/14/24 11:35:44] INFO     You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' |         rank_zero.py:63
                             'high')` which will trade-off precision for performance. For more details, read
                             https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
2024-08-14 11:35:44,580 - lightning.pytorch.utilities.rank_zero - INFO - Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Restoring states from the checkpoint path at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                       rank_zero.py:63
2024-08-14 11:35:46,099 - lightning.pytorch.accelerators.cuda - INFO - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[08/14/24 11:35:46] INFO     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]                                                                                                                                           cuda.py:58
2024-08-14 11:35:46,100 - lightning.pytorch.utilities.rank_zero - INFO - Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt
                    INFO     Loaded model weights from the checkpoint at /home/jinyao/PycharmProjects/IADBE/results/Cflow/MVTec/tile/v0/weights/lightning/model.ckpt                                        rank_zero.py:63
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:24 • 0:00:00 0.13it/s  2024-08-14 11:36:20,273 - anomalib.callbacks.timer - INFO - Testing took 33.76893424987793 seconds
Throughput (batch_size=32) : 3.6720140198220275 FPS
[08/14/24 11:36:20] INFO     Testing took 33.76893424987793 seconds                                                                                                                                            timer.py:109
                             Throughput (batch_size=32) : 3.6720140198220275 FPS
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        image_AUROC        │    0.5584239363670349     │
│         image_PRO         │            1.0            │
│        pixel_AUROC        │    0.7097617983818054     │
│         pixel_PRO         │            0.0            │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4/4 0:00:24 • 0:00:00 0.13it/s

